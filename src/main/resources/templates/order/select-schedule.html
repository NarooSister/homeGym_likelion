<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="card mb-3">
    <div class="card-header">스케줄 선택</div>
    <div class="card-body">
        <form id="applyForm" th:action="@{'introduce/program/{programId}/apply'}" method="post">
            <div class="form-group">
                <label for="week" class="form-label">요일</label>
                <select id="week" name="week" class="form-select" required>
                    <option value="">요일 선택</option>
                    <option th:each="week : ${T(com.example.homeGym.instructor.entity.Week).values()}"
                            th:value="${week}" th:text="${week.koreanName}">Week slot
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label for="time" class="form-label">시간</label>
                <select id="time" name="time" class="form-select" required>
                    <option value="">시간 선택</option>
                    <option th:each="time : ${T(com.example.homeGym.instructor.entity.Time).values()}"
                            th:value="${time}" th:text="${time.description}">Time slot
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label for="count" class="form-label">회차권 선택</label>
                <select id="count" name="count" class="form-select" required onchange="calculateAmount()">
                    <option value="">회차권 선택</option>
                    <option value="1">1회</option>
                    <option value="10">10회</option>
                    <option value="20">20회</option>
                </select>
                <input type="hidden" id="amount" name="amount" value="">
            </div>

            <button type="button" class="btn btn-outline-primary mr-1" onclick="apply()">신청하기</button>
        </form>
    </div>
</div>

<script>
    function apply() {
        // 회차권 선택 정보를 가져옵니다.
        var week = document.getElementById("week").value;
        var time = document.getElementById("time").value;
        var count = document.getElementById("count").value; // 회차권 선택값 추가

        // 회차권 선택값을 form 데이터에 추가합니다.
        var form = document.getElementById("applyForm");
        var countInput = document.createElement("input");
        countInput.setAttribute("type", "hidden");
        countInput.setAttribute("name", "count");
        countInput.setAttribute("value", count);
        form.appendChild(countInput);

        // 신청 정보를 서버에 제출합니다.
        form.submit();
    }

    function calculateAmount() {
        var count = document.getElementById("count").value;
        var amountInput = document.getElementById("amount");

        // 프로그램의 가격을 가져와서 amountInput에 설정합니다.
        if (count === "1") {
            amountInput.value = "${program.price1}";
        } else if (count === "10") {
            amountInput.value = "${program.price10}";
        } else if (count === "20") {
            amountInput.value = "${program.price20}";
        } else {
            amountInput.value = ""; // 회차권을 선택하지 않은 경우 가격을 비웁니다.
        }
    }
</script>

</body>
</html>
